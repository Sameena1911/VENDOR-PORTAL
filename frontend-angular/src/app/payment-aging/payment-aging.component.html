<div class="payment-aging-container">
  <!-- Header Section -->
  <div class="section-header">
    <div class="header-content">
      <h2>‚è∞ Payment and Aging Reports</h2>
      <p>Track payment status and aging analysis from SAP backend</p>
    </div>
    <button class="refresh-btn" (click)="refreshData()" [disabled]="loading">
      <span class="refresh-icon" [class.spinning]="loading">üîÑ</span>
      Refresh Data
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Fetching payment aging data from SAP...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error-container">
    <div class="error-message">
      <span class="error-icon">‚ö†Ô∏è</span>
      <div>
        <h3>Error Loading Data</h3>
        <p>{{ error }}</p>
        <button class="retry-btn" (click)="refreshData()">Try Again</button>
      </div>
    </div>
  </div>

  <!-- Summary Cards -->
  <div *ngIf="summary && !loading && !error" class="summary-section">
    <div class="summary-cards">
      <div class="summary-card current">
        <div class="card-header">
          <h4>Current</h4>
          <span class="status-indicator current"></span>
        </div>
        <div class="card-content">
          <div class="amount">{{ formatCurrency(summary.current.amount) }}</div>
          <div class="count">{{ summary.current.count }} Invoices</div>
        </div>
      </div>

      <div class="summary-card days30">
        <div class="card-header">
          <h4>1-30 Days</h4>
          <span class="status-indicator days30"></span>
        </div>
        <div class="card-content">
          <div class="amount">{{ formatCurrency(summary.days30.amount) }}</div>
          <div class="count">{{ summary.days30.count }} Invoices</div>
        </div>
      </div>

      <div class="summary-card days60">
        <div class="card-header">
          <h4>31-60 Days</h4>
          <span class="status-indicator days60"></span>
        </div>
        <div class="card-content">
          <div class="amount">{{ formatCurrency(summary.days60.amount) }}</div>
          <div class="count">{{ summary.days60.count }} Invoices</div>
        </div>
      </div>

      <div class="summary-card days90">
        <div class="card-header">
          <h4>61-90 Days</h4>
          <span class="status-indicator days90"></span>
        </div>
        <div class="card-content">
          <div class="amount">{{ formatCurrency(summary.days90.amount) }}</div>
          <div class="count">{{ summary.days90.count }} Invoices</div>
        </div>
      </div>

      <div class="summary-card overdue">
        <div class="card-header">
          <h4>90+ Days</h4>
          <span class="status-indicator overdue"></span>
        </div>
        <div class="card-content">
          <div class="amount">{{ formatCurrency(summary.overdue.amount) }}</div>
          <div class="count">{{ summary.overdue.count }} Invoices</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Data Table -->
  <div *ngIf="paymentData.length > 0 && !loading && !error" class="table-section">
    <div class="table-container">
      <table class="payment-table">
        <thead>
          <tr>
            <th>Vendor ID</th>
            <th>Document No.</th>
            <th>Posting Date</th>
            <th>Document Date</th>
            <th>Amount</th>
            <th>Currency</th>
            <th>Tax Code</th>
            <th>Baseline Date</th>
            <th>Payment Terms</th>
            <th>Due Date</th>
            <th>Aging Days</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of getPaginatedData(); trackBy: trackByDocumentNumber" class="table-row">
            <td>{{ item.vendorId }}</td>
            <td class="document-number">{{ item.documentNumber }}</td>
            <td>{{ item.postingDate }}</td>
            <td>{{ item.documentDate }}</td>
            <td class="amount">{{ formatCurrency(item.amount, item.currency) }}</td>
            <td class="currency">{{ item.currency }}</td>
            <td>{{ item.taxCode || '-' }}</td>
            <td>{{ item.baselineDate }}</td>
            <td class="payment-terms">{{ item.paymentTerms || '-' }}</td>
            <td>{{ item.dueDate }}</td>
            <td class="aging-days" [class]="getStatusClass(item.status)">{{ item.agingDays }}</td>
            <td>
              <span class="status-badge" [class]="getStatusClass(item.status)">
                {{ item.status }}
              </span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination Controls -->
    <div *ngIf="totalPages > 1" class="pagination-container">
      <div class="pagination-info">        
        <div class="pagination-details">
          <span>Showing {{ (currentPage - 1) * itemsPerPage + 1 }} - {{ Math.min(currentPage * itemsPerPage, totalItems) }} of {{ totalItems }} records</span>
        </div>
      </div>

      <div class="pagination-controls">
        <button class="pagination-btn" (click)="goToFirstPage()" [disabled]="currentPage === 1" title="First Page">
          <span class="pagination-icon">‚èÆÔ∏è</span>
        </button>
        
        <button class="pagination-btn" (click)="goToPreviousPage()" [disabled]="currentPage === 1" title="Previous Page">
          <span class="pagination-icon">‚óÄÔ∏è</span>
        </button>
        
        <div class="page-numbers">
          <button 
            *ngFor="let page of getPageNumbers()" 
            class="page-btn" 
            [class.active]="page === currentPage"
            (click)="goToPage(page)">
            {{ page }}
          </button>
        </div>
        
        <button class="pagination-btn" (click)="goToNextPage()" [disabled]="currentPage === totalPages" title="Next Page">
          <span class="pagination-icon">‚ñ∂Ô∏è</span>
        </button>
        
        <button class="pagination-btn" (click)="goToLastPage()" [disabled]="currentPage === totalPages" title="Last Page">
          <span class="pagination-icon">‚è≠Ô∏è</span>
        </button>
      </div>
    </div>
  </div>

  <!-- No Data State -->
  <div *ngIf="!loading && !error && paymentData.length === 0" class="no-data-container">
    <div class="no-data-message">
      <span class="no-data-icon">üìä</span>
      <h3>No Payment Data Available</h3>
      <p>No payment aging records found for your vendor account.</p>
      <button class="refresh-btn" (click)="refreshData()">Refresh Data</button>
    </div>
  </div>
</div>
